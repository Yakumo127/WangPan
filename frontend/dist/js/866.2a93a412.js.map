{"version":3,"file":"js/866.2a93a412.js","mappings":"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","sources":["webpack://enterprise-file-manager-frontend/./src/views/admin/Files.vue","webpack://enterprise-file-manager-frontend/./src/views/admin/Files.vue?6022","webpack://enterprise-file-manager-frontend/./src/api/file.js"],"sourcesContent":["<template>\n  <div class=\"files-container\">\n    <el-card class=\"box-card\">\n      <template #header>\n        <div class=\"card-header\">\n          <span>文件管理</span>\n          <el-button type=\"primary\" @click=\"showUploadDialog = true\">\n            上传文件\n          </el-button>\n        </div>\n      </template>\n      \n      <el-table :data=\"files\" style=\"width: 100%\">\n        <el-table-column prop=\"fileName\" label=\"文件名\" width=\"200\" />\n        <el-table-column prop=\"fileSize\" label=\"文件大小\" width=\"120\">\n          <template #default=\"scope\">\n            {{ formatFileSize(scope.row.fileSize) }}\n          </template>\n        </el-table-column>\n        <el-table-column prop=\"contentType\" label=\"文件类型\" width=\"120\" />\n        <el-table-column prop=\"downloadCount\" label=\"下载次数\" width=\"100\" />\n        <el-table-column prop=\"createTime\" label=\"创建时间\" width=\"180\">\n          <template #default=\"scope\">\n            {{ formatDate(scope.row.createTime) }}\n          </template>\n        </el-table-column>\n        <el-table-column label=\"操作\" width=\"200\">\n          <template #default=\"scope\">\n            <el-button size=\"small\" @click=\"downloadFile(scope.row)\">\n              下载\n            </el-button>\n            <el-button size=\"small\" type=\"danger\" @click=\"deleteFile(scope.row)\">\n              删除\n            </el-button>\n          </template>\n        </el-table-column>\n      </el-table>\n      \n      <div class=\"pagination\">\n        <el-pagination\n          v-model:current-page=\"currentPage\"\n          v-model:page-size=\"pageSize\"\n          :total=\"total\"\n          :page-sizes=\"[10, 20, 50, 100]\"\n          layout=\"total, sizes, prev, pager, next, jumper\"\n          @size-change=\"handleSizeChange\"\n          @current-change=\"handleCurrentChange\"\n        />\n      </div>\n    </el-card>\n    \n    <!-- 上传对话框 -->\n    <el-dialog v-model=\"showUploadDialog\" title=\"上传文件\" width=\"500px\">\n      <el-upload\n        class=\"upload-demo\"\n        drag\n        action=\"/api/files/upload\"\n        :headers=\"uploadHeaders\"\n        :on-success=\"handleUploadSuccess\"\n        :on-error=\"handleUploadError\"\n        :before-upload=\"beforeUpload\"\n      >\n        <el-icon class=\"el-icon--upload\"><upload-filled /></el-icon>\n        <div class=\"el-upload__text\">\n          拖拽文件到此处或 <em>点击上传</em>\n        </div>\n      </el-upload>\n    </el-dialog>\n  </div>\n</template>\n\n<script>\nimport { ref, onMounted } from 'vue'\nimport { ElMessage, ElMessageBox } from 'element-plus'\nimport { UploadFilled } from '@element-plus/icons-vue'\nimport { getFiles, deleteFile as deleteFileApi } from '@/api/file'\nimport { getToken } from '@/utils/auth'\n\nexport default {\n  name: 'Files',\n  components: {\n    UploadFilled\n  },\n  setup() {\n    const files = ref([])\n    const currentPage = ref(1)\n    const pageSize = ref(20)\n    const total = ref(0)\n    const showUploadDialog = ref(false)\n    \n    const uploadHeaders = {\n      'Authorization': `Bearer ${getToken()}`\n    }\n    \n    const loadFiles = async () => {\n      try {\n        const response = await getFiles({\n          page: currentPage.value - 1,\n          size: pageSize.value\n        })\n        files.value = response.data.content\n        total.value = response.data.totalElements\n      } catch (error) {\n        ElMessage.error('加载文件列表失败')\n      }\n    }\n    \n    const handleSizeChange = (val) => {\n      pageSize.value = val\n      loadFiles()\n    }\n    \n    const handleCurrentChange = (val) => {\n      currentPage.value = val\n      loadFiles()\n    }\n    \n    const downloadFile = (file) => {\n      window.open(`/api/files/download/${file.id}`, '_blank')\n    }\n    \n    const deleteFile = async (file) => {\n      try {\n        await ElMessageBox.confirm('确定要删除这个文件吗？', '提示', {\n          confirmButtonText: '确定',\n          cancelButtonText: '取消',\n          type: 'warning'\n        })\n        \n        await deleteFileApi(file.id)\n        ElMessage.success('删除成功')\n        loadFiles()\n      } catch (error) {\n        if (error !== 'cancel') {\n          ElMessage.error('删除失败')\n        }\n      }\n    }\n    \n    const beforeUpload = (file) => {\n      const isLt100M = file.size / 1024 / 1024 < 100\n      if (!isLt100M) {\n        ElMessage.error('文件大小不能超过 100MB!')\n      }\n      return isLt100M\n    }\n    \n    const handleUploadSuccess = () => {\n      ElMessage.success('上传成功')\n      showUploadDialog.value = false\n      loadFiles()\n    }\n    \n    const handleUploadError = () => {\n      ElMessage.error('上传失败')\n    }\n    \n    const formatFileSize = (bytes) => {\n      if (bytes === 0) return '0 B'\n      const k = 1024\n      const sizes = ['B', 'KB', 'MB', 'GB']\n      const i = Math.floor(Math.log(bytes) / Math.log(k))\n      return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i]\n    }\n    \n    const formatDate = (dateString) => {\n      return new Date(dateString).toLocaleString()\n    }\n    \n    onMounted(() => {\n      loadFiles()\n    })\n    \n    return {\n      files,\n      currentPage,\n      pageSize,\n      total,\n      showUploadDialog,\n      uploadHeaders,\n      handleSizeChange,\n      handleCurrentChange,\n      downloadFile,\n      deleteFile,\n      beforeUpload,\n      handleUploadSuccess,\n      handleUploadError,\n      formatFileSize,\n      formatDate\n    }\n  }\n}\n</script>\n\n<style scoped>\n.files-container {\n  padding: 20px;\n}\n\n.card-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n}\n\n.pagination {\n  margin-top: 20px;\n  text-align: right;\n}\n\n.upload-demo {\n  text-align: center;\n}\n</style>","import { render } from \"./Files.vue?vue&type=template&id=074017a4&scoped=true\"\nimport script from \"./Files.vue?vue&type=script&lang=js\"\nexport * from \"./Files.vue?vue&type=script&lang=js\"\n\nimport \"./Files.vue?vue&type=style&index=0&id=074017a4&scoped=true&lang=css\"\n\nimport exportComponent from \"../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-074017a4\"]])\n\nexport default __exports__","import request from \"@/utils/request\"\n\nexport function getFileList(params) {\n  return request({\n    url: \"/files/list\",\n    method: \"get\",\n    params\n  })\n}\n\nexport function uploadFile(data, onUploadProgress) {\n  return request({\n    url: \"/files/upload\",\n    method: \"post\",\n    data,\n    onUploadProgress,\n    timeout: 300000\n  })\n}\n\nexport function downloadFile(id) {\n  return request({\n    url: `/files/download/${id}`,\n    method: \"get\",\n    responseType: \"blob\"\n  })\n}\n\nexport function deleteFile(id) {\n  return request({\n    url: `/files/${id}`,\n    method: \"delete\"\n  })\n}\n\nexport function renameFile(id, name) {\n  return request({\n    url: `/files/${id}/rename`,\n    method: \"put\",\n    data: { name }\n  })\n}\n\nexport function moveFile(id, folderId) {\n  return request({\n    url: `/files/${id}/move`,\n    method: \"post\",\n    data: { folderId }\n  })\n}\n\nexport function copyFile(id, folderId) {\n  return request({\n    url: `/files/${id}/copy`,\n    method: \"post\",\n    data: { folderId }\n  })\n}\n\nexport function searchFiles(keyword) {\n  return request({\n    url: \"/files/search\",\n    method: \"get\",\n    params: { keyword }\n  })\n}\n\nexport function getFileThumbnail(id) {\n  return request({\n    url: `/files/thumbnail/${id}`,\n    method: \"get\",\n    responseType: \"blob\"\n  })\n}\n\nexport function getRecycleBinFiles() {\n  return request({\n    url: \"/files/recycle/bin\",\n    method: \"get\"\n  })\n}\n\nexport function restoreFile(id) {\n  return request({\n    url: `/files/${id}/restore`,\n    method: \"put\"\n  })\n}\n\nexport function permanentDeleteFile(id) {\n  return request({\n    url: `/files/recycle/bin/${id}`,\n    method: \"delete\"\n  })\n}\n\nexport function emptyRecycleBin() {\n  return request({\n    url: \"/files/recycle/bin/empty\",\n    method: \"delete\"\n  })\n}\n"],"names":["class","_createElementBlock","_hoisted_1","_createVNode","_component_el_card","header","_withCtx","_createElementVNode","_hoisted_2","_component_el_button","type","onClick","_cache","$event","$setup","showUploadDialog","_component_el_table","data","files","style","_component_el_table_column","prop","label","width","default","scope","formatFileSize","row","fileSize","formatDate","createTime","size","downloadFile","deleteFile","_hoisted_3","_component_el_pagination","currentPage","pageSize","total","layout","onSizeChange","handleSizeChange","onCurrentChange","handleCurrentChange","_component_el_dialog","title","_component_el_upload","drag","action","headers","uploadHeaders","handleUploadSuccess","handleUploadError","beforeUpload","_component_el_icon","_component_upload_filled","name","components","UploadFilled","setup","ref","getToken","loadFiles","async","response","getFiles","page","value","content","totalElements","error","ElMessage","val","file","window","open","id","ElMessageBox","confirm","confirmButtonText","cancelButtonText","deleteFileApi","success","isLt100M","bytes","k","sizes","i","Math","floor","log","parseFloat","pow","toFixed","dateString","Date","toLocaleString","onMounted","__exports__","render","getFileList","params","request","url","method","uploadFile","onUploadProgress","timeout","responseType","renameFile","searchFiles","keyword","getRecycleBinFiles","restoreFile","permanentDeleteFile","emptyRecycleBin"],"sourceRoot":""}