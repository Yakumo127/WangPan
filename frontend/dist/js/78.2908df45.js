"use strict";(self["webpackChunkenterprise_file_manager_frontend"]=self["webpackChunkenterprise_file_manager_frontend"]||[]).push([[78],{6078:function(e,l,a){a.r(l),a.d(l,{default:function(){return $}});var t=a(6768),i=a(144),s=a(5130),d=a(4232),o=a(1219),n=a(2933),u=a(7477);const r={class:"share-container"},c={class:"toolbar"},k={class:"toolbar-left"},p={class:"toolbar-right"},b={class:"stats-row"},f={class:"stat-icon"},m={class:"stat-info"},v={class:"stat-number"},_={class:"stat-icon"},F={class:"stat-info"},h={class:"stat-number"},y={class:"stat-icon"},w={class:"stat-info"},g={class:"stat-number"},x={class:"stat-icon"},C={class:"stat-info"},L={class:"stat-number"},T={class:"share-list"},V={class:"share-info"},R={class:"share-details"},W={class:"share-name"},z={class:"share-meta"},S={class:"share-size"},U={class:"share-link"},D={key:1,class:"no-expire"},K={class:"share-stats"},X={class:"stat-item"},I={class:"stat-item"},B={class:"option-item"},M={class:"item-size"};var E={__name:"Share",setup(e){const l=(0,i.KR)(!1),a=(0,i.KR)(!1),E=(0,i.KR)([]),q=(0,i.KR)(""),O=(0,i.KR)(!1),$=(0,i.KR)([]),j=(0,i.Kh)({type:"file",itemId:"",expireType:"never",expireTime:null,requireCode:!1}),A=(0,i.KR)({totalShares:0,activeShares:0,totalDownloads:0,totalViews:0}),G=e=>{if(!e)return"0 B";const l=1024,a=["B","KB","MB","GB","TB"],t=Math.floor(Math.log(e)/Math.log(l));return parseFloat((e/Math.pow(l,t)).toFixed(2))+" "+a[t]},N=e=>e?new Date(e).toLocaleString():"",Q=e=>new Date(e)<new Date,H=e=>e.expireTime&&Q(e.expireTime)?"已过期":e.active?"有效":"已取消",J=e=>e.expireTime&&Q(e.expireTime)?"danger":e.active?"success":"info",P=e=>e.getTime()<Date.now(),Y=async()=>{l.value=!0;try{E.value=[{id:1,name:"项目文档.pdf",type:"file",size:2048576,shareUrl:"https://example.com/share/abc123",createTime:"2024-01-15T10:30:00",expireTime:"2024-02-15T10:30:00",viewCount:25,downloadCount:8,active:!0},{id:2,name:"设计素材",type:"folder",size:10485760,shareUrl:"https://example.com/share/def456",createTime:"2024-01-10T14:20:00",expireTime:null,viewCount:15,downloadCount:3,active:!0}],A.value={totalShares:E.value.length,activeShares:E.value.filter(e=>e.active).length,totalDownloads:E.value.reduce((e,l)=>e+(l.downloadCount||0),0),totalViews:E.value.reduce((e,l)=>e+(l.viewCount||0),0)}}catch(e){o.nk.error("加载分享列表失败")}finally{l.value=!1}},Z=async()=>{try{$.value=[{id:1,name:"项目文档.pdf",type:"file",size:2048576},{id:2,name:"设计素材",type:"folder",size:10485760},{id:3,name:"会议记录.docx",type:"file",size:512e3},{id:4,name:"图片资源",type:"folder",size:5242880}]}catch(e){console.error("加载可选项目失败:",e)}},ee=()=>{Y()},le=()=>{o.nk.info("分享搜索功能开发中...")},ae=async e=>{try{await navigator.clipboard.writeText(e.shareUrl),o.nk.success("分享链接已复制到剪贴板")}catch(l){o.nk.error("复制分享链接失败")}},te=e=>{window.open(e.shareUrl,"_blank")},ie=e=>{o.nk.info("编辑分享功能开发中...")},se=async e=>{try{await n.s.confirm(`确定要取消分享 "${e.name}" 吗？`,"取消分享",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}),e.active=!1,o.nk.success("分享已取消"),await Y()}catch(l){"cancel"!==l&&o.nk.error("取消分享失败")}},de=async()=>{if(j.itemId){a.value=!0;try{const e=$.value.find(e=>e.id===j.itemId),l={id:E.value.length+1,name:e.name,type:j.type,size:e.size,shareUrl:`https://example.com/share/${Math.random().toString(36).substr(2,9)}`,createTime:(new Date).toISOString(),expireTime:"custom"===j.expireType?j.expireTime.toISOString():null,viewCount:0,downloadCount:0,active:!0};E.value.unshift(l),o.nk.success("分享创建成功"),O.value=!1,j.itemId="",j.expireType="never",j.expireTime=null,j.requireCode=!1,await Y()}catch(e){o.nk.error("创建分享失败")}finally{a.value=!1}}else o.nk.warning("请选择要分享的文件或文件夹")};return(0,t.sV)(()=>{Y(),Z()}),(e,o)=>{const n=(0,t.g2)("el-icon"),Y=(0,t.g2)("el-button"),Z=(0,t.g2)("el-input"),oe=(0,t.g2)("el-card"),ne=(0,t.g2)("el-col"),ue=(0,t.g2)("el-row"),re=(0,t.g2)("el-tag"),ce=(0,t.g2)("el-table-column"),ke=(0,t.g2)("el-button-group"),pe=(0,t.g2)("el-table"),be=(0,t.g2)("el-radio"),fe=(0,t.g2)("el-radio-group"),me=(0,t.g2)("el-form-item"),ve=(0,t.g2)("el-option"),_e=(0,t.g2)("el-select"),Fe=(0,t.g2)("el-date-picker"),he=(0,t.g2)("el-switch"),ye=(0,t.g2)("el-form"),we=(0,t.g2)("el-dialog"),ge=(0,t.gN)("loading");return(0,t.uX)(),(0,t.CE)("div",r,[(0,t.Lk)("div",c,[(0,t.Lk)("div",k,[(0,t.bF)(Y,{type:"primary",onClick:o[0]||(o[0]=e=>O.value=!0)},{default:(0,t.k6)(()=>[(0,t.bF)(n,null,{default:(0,t.k6)(()=>[(0,t.bF)((0,i.R1)(u.Share))]),_:1}),o[9]||(o[9]=(0,t.eW)(" 创建分享 ",-1))]),_:1}),(0,t.bF)(Y,{onClick:ee,loading:l.value},{default:(0,t.k6)(()=>[(0,t.bF)(n,null,{default:(0,t.k6)(()=>[(0,t.bF)((0,i.R1)(u.Refresh))]),_:1}),o[10]||(o[10]=(0,t.eW)(" 刷新 ",-1))]),_:1},8,["loading"])]),(0,t.Lk)("div",p,[(0,t.bF)(Z,{modelValue:q.value,"onUpdate:modelValue":o[1]||(o[1]=e=>q.value=e),placeholder:"搜索分享...",style:{width:"200px"},clearable:"",onKeyup:(0,s.jR)(le,["enter"])},{prefix:(0,t.k6)(()=>[(0,t.bF)(n,null,{default:(0,t.k6)(()=>[(0,t.bF)((0,i.R1)(u.Search))]),_:1})]),_:1},8,["modelValue"]),(0,t.bF)(Y,{onClick:le},{default:(0,t.k6)(()=>[...o[11]||(o[11]=[(0,t.eW)("搜索",-1)])]),_:1})])]),(0,t.Lk)("div",b,[(0,t.bF)(ue,{gutter:20},{default:(0,t.k6)(()=>[(0,t.bF)(ne,{span:6},{default:(0,t.k6)(()=>[(0,t.bF)(oe,{class:"stat-card"},{default:(0,t.k6)(()=>[(0,t.Lk)("div",f,[(0,t.bF)(n,null,{default:(0,t.k6)(()=>[(0,t.bF)((0,i.R1)(u.Share))]),_:1})]),(0,t.Lk)("div",m,[(0,t.Lk)("div",v,(0,d.v_)(A.value.totalShares||0),1),o[12]||(o[12]=(0,t.Lk)("div",{class:"stat-label"},"总分享数",-1))])]),_:1})]),_:1}),(0,t.bF)(ne,{span:6},{default:(0,t.k6)(()=>[(0,t.bF)(oe,{class:"stat-card"},{default:(0,t.k6)(()=>[(0,t.Lk)("div",_,[(0,t.bF)(n,null,{default:(0,t.k6)(()=>[(0,t.bF)((0,i.R1)(u.Link))]),_:1})]),(0,t.Lk)("div",F,[(0,t.Lk)("div",h,(0,d.v_)(A.value.activeShares||0),1),o[13]||(o[13]=(0,t.Lk)("div",{class:"stat-label"},"有效分享",-1))])]),_:1})]),_:1}),(0,t.bF)(ne,{span:6},{default:(0,t.k6)(()=>[(0,t.bF)(oe,{class:"stat-card"},{default:(0,t.k6)(()=>[(0,t.Lk)("div",y,[(0,t.bF)(n,null,{default:(0,t.k6)(()=>[(0,t.bF)((0,i.R1)(u.Download))]),_:1})]),(0,t.Lk)("div",w,[(0,t.Lk)("div",g,(0,d.v_)(A.value.totalDownloads||0),1),o[14]||(o[14]=(0,t.Lk)("div",{class:"stat-label"},"总下载次数",-1))])]),_:1})]),_:1}),(0,t.bF)(ne,{span:6},{default:(0,t.k6)(()=>[(0,t.bF)(oe,{class:"stat-card"},{default:(0,t.k6)(()=>[(0,t.Lk)("div",x,[(0,t.bF)(n,null,{default:(0,t.k6)(()=>[(0,t.bF)((0,i.R1)(u.View))]),_:1})]),(0,t.Lk)("div",C,[(0,t.Lk)("div",L,(0,d.v_)(A.value.totalViews||0),1),o[15]||(o[15]=(0,t.Lk)("div",{class:"stat-label"},"总浏览次数",-1))])]),_:1})]),_:1})]),_:1})]),(0,t.Lk)("div",T,[(0,t.bo)(((0,t.uX)(),(0,t.Wv)(pe,{data:E.value,style:{width:"100%"}},{default:(0,t.k6)(()=>[(0,t.bF)(ce,{label:"文件信息","min-width":"300"},{default:(0,t.k6)(({row:e})=>[(0,t.Lk)("div",V,[(0,t.bF)(n,{class:"share-icon"},{default:(0,t.k6)(()=>["file"===e.type?((0,t.uX)(),(0,t.Wv)((0,i.R1)(u.Document),{key:0})):((0,t.uX)(),(0,t.Wv)((0,i.R1)(u.Folder),{key:1}))]),_:2},1024),(0,t.Lk)("div",R,[(0,t.Lk)("div",W,(0,d.v_)(e.name),1),(0,t.Lk)("div",z,[(0,t.bF)(re,{size:"small",type:"file"===e.type?"primary":"success"},{default:(0,t.k6)(()=>[(0,t.eW)((0,d.v_)("file"===e.type?"文件":"文件夹"),1)]),_:2},1032,["type"]),(0,t.Lk)("span",S,(0,d.v_)(G(e.size)),1)])])])]),_:1}),(0,t.bF)(ce,{label:"分享链接","min-width":"200"},{default:(0,t.k6)(({row:e})=>[(0,t.Lk)("div",U,[(0,t.bF)(Z,{modelValue:e.shareUrl,"onUpdate:modelValue":l=>e.shareUrl=l,readonly:"",size:"small",style:{width:"100%"}},{append:(0,t.k6)(()=>[(0,t.bF)(Y,{onClick:l=>ae(e),size:"small"},{default:(0,t.k6)(()=>[(0,t.bF)(n,null,{default:(0,t.k6)(()=>[(0,t.bF)((0,i.R1)(u.CopyDocument))]),_:1})]),_:1},8,["onClick"])]),_:2},1032,["modelValue","onUpdate:modelValue"])])]),_:1}),(0,t.bF)(ce,{prop:"createTime",label:"创建时间",width:"180"},{default:(0,t.k6)(({row:e})=>[(0,t.eW)((0,d.v_)(N(e.createTime)),1)]),_:1}),(0,t.bF)(ce,{prop:"expireTime",label:"过期时间",width:"180"},{default:(0,t.k6)(({row:e})=>[e.expireTime?((0,t.uX)(),(0,t.CE)("span",{key:0,class:(0,d.C4)({expired:Q(e.expireTime)})},(0,d.v_)(N(e.expireTime)),3)):((0,t.uX)(),(0,t.CE)("span",D,"永久有效"))]),_:1}),(0,t.bF)(ce,{label:"统计",width:"120"},{default:(0,t.k6)(({row:e})=>[(0,t.Lk)("div",K,[(0,t.Lk)("div",X,[(0,t.bF)(n,null,{default:(0,t.k6)(()=>[(0,t.bF)((0,i.R1)(u.View))]),_:1}),(0,t.eW)(" "+(0,d.v_)(e.viewCount||0),1)]),(0,t.Lk)("div",I,[(0,t.bF)(n,null,{default:(0,t.k6)(()=>[(0,t.bF)((0,i.R1)(u.Download))]),_:1}),(0,t.eW)(" "+(0,d.v_)(e.downloadCount||0),1)])])]),_:1}),(0,t.bF)(ce,{label:"状态",width:"100"},{default:(0,t.k6)(({row:e})=>[(0,t.bF)(re,{type:J(e)},{default:(0,t.k6)(()=>[(0,t.eW)((0,d.v_)(H(e)),1)]),_:2},1032,["type"])]),_:1}),(0,t.bF)(ce,{label:"操作",width:"200"},{default:(0,t.k6)(({row:e})=>[(0,t.bF)(ke,null,{default:(0,t.k6)(()=>[(0,t.bF)(Y,{size:"small",onClick:l=>te(e)},{default:(0,t.k6)(()=>[(0,t.bF)(n,null,{default:(0,t.k6)(()=>[(0,t.bF)((0,i.R1)(u.View))]),_:1}),o[16]||(o[16]=(0,t.eW)(" 查看 ",-1))]),_:1},8,["onClick"]),(0,t.bF)(Y,{size:"small",onClick:l=>ie(e)},{default:(0,t.k6)(()=>[(0,t.bF)(n,null,{default:(0,t.k6)(()=>[(0,t.bF)((0,i.R1)(u.Edit))]),_:1}),o[17]||(o[17]=(0,t.eW)(" 编辑 ",-1))]),_:1},8,["onClick"]),(0,t.bF)(Y,{size:"small",type:"danger",onClick:l=>se(e)},{default:(0,t.k6)(()=>[(0,t.bF)(n,null,{default:(0,t.k6)(()=>[(0,t.bF)((0,i.R1)(u.Delete))]),_:1}),o[18]||(o[18]=(0,t.eW)(" 取消 ",-1))]),_:1},8,["onClick"])]),_:2},1024)]),_:1})]),_:1},8,["data"])),[[ge,l.value]])]),(0,t.bF)(we,{modelValue:O.value,"onUpdate:modelValue":o[8]||(o[8]=e=>O.value=e),title:"创建分享",width:"600px"},{footer:(0,t.k6)(()=>[(0,t.bF)(Y,{onClick:o[7]||(o[7]=e=>O.value=!1)},{default:(0,t.k6)(()=>[...o[23]||(o[23]=[(0,t.eW)("取消",-1)])]),_:1}),(0,t.bF)(Y,{type:"primary",onClick:de,loading:a.value},{default:(0,t.k6)(()=>[...o[24]||(o[24]=[(0,t.eW)(" 创建分享 ",-1)])]),_:1},8,["loading"])]),default:(0,t.k6)(()=>[(0,t.bF)(ye,{model:j,"label-width":"100px"},{default:(0,t.k6)(()=>[(0,t.bF)(me,{label:"选择类型"},{default:(0,t.k6)(()=>[(0,t.bF)(fe,{modelValue:j.type,"onUpdate:modelValue":o[2]||(o[2]=e=>j.type=e)},{default:(0,t.k6)(()=>[(0,t.bF)(be,{label:"file"},{default:(0,t.k6)(()=>[...o[19]||(o[19]=[(0,t.eW)("文件",-1)])]),_:1}),(0,t.bF)(be,{label:"folder"},{default:(0,t.k6)(()=>[...o[20]||(o[20]=[(0,t.eW)("文件夹",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1}),(0,t.bF)(me,{label:"file"===j.type?"选择文件":"选择文件夹"},{default:(0,t.k6)(()=>[(0,t.bF)(_e,{modelValue:j.itemId,"onUpdate:modelValue":o[3]||(o[3]=e=>j.itemId=e),placeholder:"请选择"+("file"===j.type?"文件":"文件夹"),style:{width:"100%"},filterable:""},{default:(0,t.k6)(()=>[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)($.value,e=>((0,t.uX)(),(0,t.Wv)(ve,{key:e.id,label:e.name,value:e.id},{default:(0,t.k6)(()=>[(0,t.Lk)("div",B,[(0,t.bF)(n,null,{default:(0,t.k6)(()=>["file"===j.type?((0,t.uX)(),(0,t.Wv)((0,i.R1)(u.Document),{key:0})):((0,t.uX)(),(0,t.Wv)((0,i.R1)(u.Folder),{key:1}))]),_:1}),(0,t.Lk)("span",null,(0,d.v_)(e.name),1),(0,t.Lk)("span",M,(0,d.v_)(G(e.size)),1)])]),_:2},1032,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),(0,t.bF)(me,{label:"过期时间"},{default:(0,t.k6)(()=>[(0,t.bF)(fe,{modelValue:j.expireType,"onUpdate:modelValue":o[4]||(o[4]=e=>j.expireType=e)},{default:(0,t.k6)(()=>[(0,t.bF)(be,{label:"never"},{default:(0,t.k6)(()=>[...o[21]||(o[21]=[(0,t.eW)("永久有效",-1)])]),_:1}),(0,t.bF)(be,{label:"custom"},{default:(0,t.k6)(()=>[...o[22]||(o[22]=[(0,t.eW)("自定义时间",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1}),"custom"===j.expireType?((0,t.uX)(),(0,t.Wv)(me,{key:0,label:"选择时间"},{default:(0,t.k6)(()=>[(0,t.bF)(Fe,{modelValue:j.expireTime,"onUpdate:modelValue":o[5]||(o[5]=e=>j.expireTime=e),type:"datetime",placeholder:"选择过期时间","disabled-date":P,style:{width:"100%"}},null,8,["modelValue"])]),_:1})):(0,t.Q3)("",!0),(0,t.bF)(me,{label:"提取码"},{default:(0,t.k6)(()=>[(0,t.bF)(he,{modelValue:j.requireCode,"onUpdate:modelValue":o[6]||(o[6]=e=>j.requireCode=e),"active-text":"需要提取码","inactive-text":"不需要提取码"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])])}}},q=a(1241);const O=(0,q.A)(E,[["__scopeId","data-v-4d0031fa"]]);var $=O}}]);
//# sourceMappingURL=78.2908df45.js.map