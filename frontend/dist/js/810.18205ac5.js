"use strict";(self["webpackChunkenterprise_file_manager_frontend"]=self["webpackChunkenterprise_file_manager_frontend"]||[]).push([[810],{7504:function(e,t,a){a.d(t,{H5:function(){return u},Jk:function(){return n},QF:function(){return k},QM:function(){return i},VX:function(){return d},Ww:function(){return r},_K:function(){return o},cH:function(){return f},downloadFile:function(){return s},wb:function(){return c}});var l=a(5720);function n(e){return(0,l.A)({url:"/files/list",method:"get",params:e})}function i(e,t){return(0,l.A)({url:"/files/upload",method:"post",data:e,onUploadProgress:t,timeout:3e5})}function s(e){return(0,l.A)({url:`/files/download/${e}`,method:"get",responseType:"blob"})}function r(e){return(0,l.A)({url:`/files/${e}`,method:"delete"})}function u(e,t){return(0,l.A)({url:`/files/${e}/rename`,method:"put",data:{name:t}})}function o(e){return(0,l.A)({url:"/files/search",method:"get",params:{keyword:e}})}function c(){return(0,l.A)({url:"/files/recycle/bin",method:"get"})}function d(e){return(0,l.A)({url:`/files/${e}/restore`,method:"put"})}function k(e){return(0,l.A)({url:`/files/recycle/bin/${e}`,method:"delete"})}function f(){return(0,l.A)({url:"/files/recycle/bin/empty",method:"delete"})}},8810:function(e,t,a){a.r(t),a.d(t,{default:function(){return G}});var l=a(6768),n=a(4232),i=a(144),s=a(1387),r=a(1219),u=a(7477),o=a(7504),c=a(7756);const d={class:"home-container"},k={class:"welcome-section"},f={class:"stat-icon"},v={class:"stat-info"},b={class:"stat-number"},m={class:"stat-icon"},F={class:"stat-info"},p={class:"stat-number"},g={class:"stat-icon"},_={class:"stat-info"},L={class:"stat-number"},h={class:"stat-icon"},y={class:"stat-info"},w={class:"stat-number"},R={class:"quick-actions"},C={class:"storage-info"},D={class:"storage-header"},M={class:"card-header"},W={class:"recent-activity"},X={key:0,class:"empty-activity"},A={class:"activity-icon"},B={class:"activity-content"},E={class:"activity-title"},K={class:"activity-time"},T={class:"card-header"},U={class:"recent-files"},z={key:0,class:"empty-files"},S={key:1,class:"file-grid"},$=["onClick"],x={class:"file-icon"},q={class:"file-name"},H={class:"file-size"},I={class:"file-time"};var O={__name:"Home",setup(e){const t=(0,s.rd)(),O=(0,c.n)(),P=(0,i.KR)(!1),j=(0,i.KR)({totalFiles:0,totalFolders:0,usedStorage:0,storageLimit:1073741824}),G=(0,i.KR)([]),J=(0,i.KR)([]),N=(0,l.EW)(()=>O.user),Q=(0,l.EW)(()=>(new Date).toLocaleDateString("zh-CN",{year:"numeric",month:"long",day:"numeric",weekday:"long"})),V=(0,l.EW)(()=>j.value.storageLimit?Math.round(j.value.usedStorage/j.value.storageLimit*100):0),Y=e=>{if(!e)return"0 B";const t=1024,a=["B","KB","MB","GB","TB"],l=Math.floor(Math.log(e)/Math.log(t));return parseFloat((e/Math.pow(t,l)).toFixed(2))+" "+a[l]},Z=e=>{if(!e)return"0 B";const t=1024,a=["B","KB","MB","GB"],l=Math.floor(Math.log(e)/Math.log(t));return parseFloat((e/Math.pow(t,l)).toFixed(2))+" "+a[l]},ee=e=>{if(!e)return"";const t=new Date(e),a=new Date,l=a-t;return l<6e4?"刚刚":l<36e5?Math.floor(l/6e4)+"分钟前":l<864e5?Math.floor(l/36e5)+"小时前":l<6048e5?Math.floor(l/864e5)+"天前":t.toLocaleDateString()},te=async()=>{P.value=!0;try{const e=await(0,o.Jk)(),t=e||[];j.value={totalFiles:t.length,totalFolders:t.filter(e=>e.isDirectory).length,usedStorage:t.reduce((e,t)=>e+(t.size||0),0),storageLimit:N.value?.quotaLimit||1073741824},J.value=t.filter(e=>!e.isDirectory).sort((e,t)=>new Date(t.createTime)-new Date(e.createTime)).slice(0,8),G.value=t.sort((e,t)=>new Date(t.createTime)-new Date(e.createTime)).slice(0,5).map(e=>({id:e.id,type:"upload",title:`上传了文件 "${e.originalFilename||e.name}"`,time:e.createTime}))}catch(e){r.nk.error("加载统计信息失败")}finally{P.value=!1}},ae=()=>{te()},le=()=>{t.push("/files")},ne=()=>{t.push("/files")},ie=()=>{t.push("/profile")},se=async e=>{try{const{downloadFile:t}=await Promise.resolve().then(a.bind(a,7504)),l=await t(e.id),n=new Blob([l.data]),i=window.URL.createObjectURL(n),s=document.createElement("a");s.href=i,s.download=e.originalFilename||e.name,document.body.appendChild(s),s.click(),window.URL.revokeObjectURL(i),document.body.removeChild(s)}catch(t){r.nk.error("文件下载失败")}};return(0,l.sV)(()=>{te()}),(e,t)=>{const a=(0,l.g2)("el-icon"),s=(0,l.g2)("el-card"),r=(0,l.g2)("el-col"),o=(0,l.g2)("el-row"),c=(0,l.g2)("el-button"),O=(0,l.g2)("el-progress");return(0,l.uX)(),(0,l.CE)("div",d,[(0,l.Lk)("div",k,[(0,l.Lk)("h1",null,"欢迎回来，"+(0,n.v_)(N.value?.displayName||N.value?.username||"用户"),1),(0,l.Lk)("p",null,"今天是 "+(0,n.v_)(Q.value)+"，祝您工作愉快！",1)]),(0,l.bF)(o,{gutter:20,class:"stats-row"},{default:(0,l.k6)(()=>[(0,l.bF)(r,{span:6},{default:(0,l.k6)(()=>[(0,l.bF)(s,{class:"stat-card",loading:P.value},{default:(0,l.k6)(()=>[(0,l.Lk)("div",f,[(0,l.bF)(a,null,{default:(0,l.k6)(()=>[(0,l.bF)((0,i.R1)(u.Document))]),_:1})]),(0,l.Lk)("div",v,[(0,l.Lk)("div",b,(0,n.v_)(j.value.totalFiles||0),1),t[0]||(t[0]=(0,l.Lk)("div",{class:"stat-label"},"我的文件",-1))])]),_:1},8,["loading"])]),_:1}),(0,l.bF)(r,{span:6},{default:(0,l.k6)(()=>[(0,l.bF)(s,{class:"stat-card",loading:P.value},{default:(0,l.k6)(()=>[(0,l.Lk)("div",m,[(0,l.bF)(a,null,{default:(0,l.k6)(()=>[(0,l.bF)((0,i.R1)(u.FolderOpened))]),_:1})]),(0,l.Lk)("div",F,[(0,l.Lk)("div",p,(0,n.v_)(j.value.totalFolders||0),1),t[1]||(t[1]=(0,l.Lk)("div",{class:"stat-label"},"我的文件夹",-1))])]),_:1},8,["loading"])]),_:1}),(0,l.bF)(r,{span:6},{default:(0,l.k6)(()=>[(0,l.bF)(s,{class:"stat-card",loading:P.value},{default:(0,l.k6)(()=>[(0,l.Lk)("div",g,[(0,l.bF)(a,null,{default:(0,l.k6)(()=>[(0,l.bF)((0,i.R1)(u.DataLine))]),_:1})]),(0,l.Lk)("div",_,[(0,l.Lk)("div",L,(0,n.v_)(Y(j.value.usedStorage||0)),1),t[2]||(t[2]=(0,l.Lk)("div",{class:"stat-label"},"已用存储",-1))])]),_:1},8,["loading"])]),_:1}),(0,l.bF)(r,{span:6},{default:(0,l.k6)(()=>[(0,l.bF)(s,{class:"stat-card",loading:P.value},{default:(0,l.k6)(()=>[(0,l.Lk)("div",h,[(0,l.bF)(a,null,{default:(0,l.k6)(()=>[(0,l.bF)((0,i.R1)(u.PieChart))]),_:1})]),(0,l.Lk)("div",y,[(0,l.Lk)("div",w,(0,n.v_)(V.value)+"%",1),t[3]||(t[3]=(0,l.Lk)("div",{class:"stat-label"},"存储使用率",-1))])]),_:1},8,["loading"])]),_:1})]),_:1}),(0,l.bF)(o,{gutter:20,class:"content-row"},{default:(0,l.k6)(()=>[(0,l.bF)(r,{span:12},{default:(0,l.k6)(()=>[(0,l.bF)(s,{class:"quick-actions-card"},{header:(0,l.k6)(()=>[...t[4]||(t[4]=[(0,l.Lk)("div",{class:"card-header"},[(0,l.Lk)("span",null,"快速操作")],-1)])]),default:(0,l.k6)(()=>[(0,l.Lk)("div",R,[(0,l.bF)(c,{type:"primary",onClick:le,size:"large"},{default:(0,l.k6)(()=>[(0,l.bF)(a,null,{default:(0,l.k6)(()=>[(0,l.bF)((0,i.R1)(u.Upload))]),_:1}),t[5]||(t[5]=(0,l.eW)(" 上传文件 ",-1))]),_:1}),(0,l.bF)(c,{type:"success",onClick:ne,size:"large"},{default:(0,l.k6)(()=>[(0,l.bF)(a,null,{default:(0,l.k6)(()=>[(0,l.bF)((0,i.R1)(u.Document))]),_:1}),t[6]||(t[6]=(0,l.eW)(" 管理文件 ",-1))]),_:1}),(0,l.bF)(c,{onClick:ie,size:"large"},{default:(0,l.k6)(()=>[(0,l.bF)(a,null,{default:(0,l.k6)(()=>[(0,l.bF)((0,i.R1)(u.User))]),_:1}),t[7]||(t[7]=(0,l.eW)(" 个人中心 ",-1))]),_:1})]),(0,l.Lk)("div",C,[(0,l.Lk)("div",D,[t[8]||(t[8]=(0,l.Lk)("span",null,"存储使用情况",-1)),(0,l.Lk)("span",null,(0,n.v_)(Y(j.value.usedStorage||0))+" / "+(0,n.v_)(Y(j.value.storageLimit||1073741824)),1)]),(0,l.bF)(O,{percentage:V.value,color:V.value>80?"#f56c6c":"#409eff","stroke-width":8},null,8,["percentage","color"])])]),_:1})]),_:1}),(0,l.bF)(r,{span:12},{default:(0,l.k6)(()=>[(0,l.bF)(s,{class:"recent-activity-card"},{header:(0,l.k6)(()=>[(0,l.Lk)("div",M,[t[9]||(t[9]=(0,l.Lk)("span",null,"最近活动",-1)),(0,l.bF)(c,{onClick:ae,loading:P.value,text:""},{default:(0,l.k6)(()=>[(0,l.bF)(a,null,{default:(0,l.k6)(()=>[(0,l.bF)((0,i.R1)(u.Refresh))]),_:1})]),_:1},8,["loading"])])]),default:(0,l.k6)(()=>[(0,l.Lk)("div",W,[0===G.value.length?((0,l.uX)(),(0,l.CE)("div",X,[(0,l.bF)(a,null,{default:(0,l.k6)(()=>[(0,l.bF)((0,i.R1)(u.Document))]),_:1}),t[10]||(t[10]=(0,l.Lk)("p",null,"暂无活动记录",-1))])):((0,l.uX)(!0),(0,l.CE)(l.FK,{key:1},(0,l.pI)(G.value,e=>((0,l.uX)(),(0,l.CE)("div",{key:e.id,class:"activity-item"},[(0,l.Lk)("div",A,[(0,l.bF)(a,null,{default:(0,l.k6)(()=>["upload"===e.type?((0,l.uX)(),(0,l.Wv)((0,i.R1)(u.Document),{key:0})):"download"===e.type?((0,l.uX)(),(0,l.Wv)((0,i.R1)(u.Download),{key:1})):"delete"===e.type?((0,l.uX)(),(0,l.Wv)((0,i.R1)(u.Delete),{key:2})):((0,l.uX)(),(0,l.Wv)((0,i.R1)(u.Folder),{key:3}))]),_:2},1024)]),(0,l.Lk)("div",B,[(0,l.Lk)("div",E,(0,n.v_)(e.title),1),(0,l.Lk)("div",K,(0,n.v_)(ee(e.time)),1)])]))),128))])]),_:1})]),_:1})]),_:1}),(0,l.bF)(o,{gutter:20,class:"files-row"},{default:(0,l.k6)(()=>[(0,l.bF)(r,{span:24},{default:(0,l.k6)(()=>[(0,l.bF)(s,{class:"recent-files-card"},{header:(0,l.k6)(()=>[(0,l.Lk)("div",T,[t[12]||(t[12]=(0,l.Lk)("span",null,"最近文件",-1)),(0,l.bF)(c,{onClick:ne,type:"primary",text:""},{default:(0,l.k6)(()=>[t[11]||(t[11]=(0,l.eW)(" 查看全部 ",-1)),(0,l.bF)(a,null,{default:(0,l.k6)(()=>[(0,l.bF)((0,i.R1)(u.ArrowRight))]),_:1})]),_:1})])]),default:(0,l.k6)(()=>[(0,l.Lk)("div",U,[0===J.value.length?((0,l.uX)(),(0,l.CE)("div",z,[(0,l.bF)(a,null,{default:(0,l.k6)(()=>[(0,l.bF)((0,i.R1)(u.Document))]),_:1}),t[14]||(t[14]=(0,l.Lk)("p",null,"暂无文件",-1)),(0,l.bF)(c,{type:"primary",onClick:le},{default:(0,l.k6)(()=>[(0,l.bF)(a,null,{default:(0,l.k6)(()=>[(0,l.bF)((0,i.R1)(u.Upload))]),_:1}),t[13]||(t[13]=(0,l.eW)(" 上传第一个文件 ",-1))]),_:1})])):((0,l.uX)(),(0,l.CE)("div",S,[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(J.value,e=>((0,l.uX)(),(0,l.CE)("div",{key:e.id,class:"file-item",onClick:t=>se(e)},[(0,l.Lk)("div",x,[(0,l.bF)(a,null,{default:(0,l.k6)(()=>[e.isDirectory?((0,l.uX)(),(0,l.Wv)((0,i.R1)(u.Folder),{key:1})):((0,l.uX)(),(0,l.Wv)((0,i.R1)(u.Document),{key:0}))]),_:2},1024)]),(0,l.Lk)("div",q,(0,n.v_)(e.originalFilename||e.name),1),(0,l.Lk)("div",H,(0,n.v_)(Z(e.size)),1),(0,l.Lk)("div",I,(0,n.v_)(ee(e.createTime)),1)],8,$))),128))]))])]),_:1})]),_:1})]),_:1})])}}},P=a(1241);const j=(0,P.A)(O,[["__scopeId","data-v-2ab49ea4"]]);var G=j}}]);
//# sourceMappingURL=810.18205ac5.js.map